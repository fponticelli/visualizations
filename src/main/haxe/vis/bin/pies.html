<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>ReportGrid.Visualizations</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="language" content="en" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<link rel="stylesheet" type="text/css" href="css/rg.css"/>
	<link rel="stylesheet" href="css/rg-colors20b.css" type="text/css"/>
<!--
	<link rel="stylesheet" type="text/css" href="css/rg-debug.css"/>
-->
	<!-- FOR DIFFENT COLOR SCHEMES TRY THE FOLLOWINGS: -->
<!--
	<link rel="stylesheet" href="css/rg-colors20.css" type="text/css"/>
	<link rel="stylesheet" href="css/rg-colors20b.css" type="text/css"/>
	<link rel="stylesheet" href="css/rg-colors20c.css" type="text/css"/>
	<link rel="stylesheet" href="css/rg-colors-mono-blue.css" type="text/css"/>
	<link rel="stylesheet" href="css/rg-colors-mono-green.css" type="text/css"/>
	<link rel="stylesheet" href="css/rg-colors-mono-red.css" type="text/css"/>
-->
	<script src="js/reportgrid-core.js?tokenId=C7A18C95-3619-415B-A89B-4CE47693E4CC"></script>
	<script src="js/reportgrid-viz.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(){
	ReportGrid.pieChart("#chart3", {
		axes : [{
			type : "slice",
			variable : "independent"
		}, {
			type : "count"
		}],
		data : {
			src : {
				data : [{
					slice : "A",
					count : 1
				}, {
					slice : "B",
					count : 3
				}, {
					slice : "C",
					count : 5
				}, {
					slice : "D",
					count : 7
				}]
			}
		}
	});

	ReportGrid.pieChart("#chart1", {
		axes : [{
			type: ".ageRange"
		}, {
			type: "count"
		}],
		data : {
			src: { path : "/rgadnet", event : "impression", query : ".ageRange" }
		},
		options : {
			height : 400,
			innerradius : 0.5,
			outerradius : 0.9,
			overradius : 0.95,
			labelradius : 0.70,
			displaylabels : true,
			labelorientation : "horizontal",
			sort : function(a,b) { 
				var av = parseInt(a[".ageRange"].split("-")[0]),
					bv = parseInt(b[".ageRange"].split("-")[0]);
				return av - bv;
			},
			label : {
				title : "The Eye",
				datapoint : function(dp) { 
					var v = dp["count"];
					if(v < 6500)
						return null;
					else
						return "age " + dp[".ageRange"] + ": " + ReportGrid.format(v);
				}
			},
			layout : "simple"
		}
	});

	ReportGrid.pieChart("#chart1", {
		axes : [{
			type: ".platform"
		}, {
			type: "count"
		}],
		data : {
			src: { path : "/rgadnet", event : "impression", query : ".platform" }
		},
		options : {
			innerradius : 0.25,
			outerradius : 0.45,
			overradius : 0.49,
			labelradius : 0.27,
			labelorientation : "ortho",
			dontfliplabel : false,
			label : {
				value : function(v) { return Math.round(v/100) + "k"; }
			}
		}
	});

	ReportGrid.pieChart("#chart1", {
		axes : [{
			type : "event"
		}, {
			type: "count"
		}],
		data : {
			src: [
				{ path : "/rgadnet", event : "impression" },
				{ path : "/rgadnet", event : "click" },
				{ path : "/rgadnet", event : "conversion" }
			]
		},
		options : {
			innerradius : 0.0,
			outerradius : 0.2,
			overradius  : 0.24,
			labelradius : 0.03,
			labelorientation : "align",
			// click
			// label format
			// value format
			label : {
				value : function(v,t) { return Math.round(100 * v / t) + "%";  }
			}
		}
	});
	
	ReportGrid.pieChart("#chart2", {
		axes : [{
			type : "event"
		}, {
			type: "count"
		}],
		data : {
			src: [
				{ path : "/rgadnet", event : "impression" },
				{ path : "/rgadnet", event : "click" },
				{ path : "/rgadnet", event : "conversion" }
			]
		},
		options : {
			height : 400,
			innerradius : 0.5,
			outerradius : 0.9,
			overradius : 0.95,
			labelradius : 0.70,
			displaylabels : true,
			labelorientation : "horizontal",
			label : {
				title : "Event: Drilldown",
				datapoint : function(dp) { 
					var v = dp["count"];
					return dp["event"] + ": " + ReportGrid.format(v);
				}
			},
			layout : "simple",
			click : function(dp) {
				drillEvent(dp.event, dp.count);
			}
		}
	});
	
	var last;
	function drillEvent(name, total)
	{
		if(last) last.destroy();
		last = ReportGrid.pieChart("#chart2", {
			axes : [{
				type: ".platform"
			}, {
				type: "count"
			}],
			data : {
				src: { path : "/rgadnet", event : name, query : ".platform" }
			},
			options : {
				innerradius : 0.25,
				outerradius : 0.45,
				overradius : 0.49,
				labelradius : 0.35,
				labelorientation : "horizontal",
				dontfliplabel : false,
				label : {
					datapoint : function(dp) { 
						var v = dp["count"];
						if(v / total < 0.05)
							return null;
						if(v / total < 0.1)
							return dp[".platform"];
						else
							return dp[".platform"] + ": " + Math.round(v/1000) + "k";
					}
				}
			}
		});
	}
}, false)
</script>
</head>
<body>
	<div id="haxe:trace"></div>
	<div id="chart3"></div>
	<div id="chart1"></div>
	<div id="chart2"></div>
</body>
</html>